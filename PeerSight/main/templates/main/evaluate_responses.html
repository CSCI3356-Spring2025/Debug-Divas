{% extends 'shared/base.html' %}


{% block content %}
<form method="get" class="mb-6 space-x-4">
    <!-- Course filter -->
    <select name="course" onchange="this.form.submit()">
        <option value="">Select a course</option>
        {% for course in courses %}
        <option value="{{ course.id }}" {% if course.id|stringformat:"s" == selected_course_id %}selected{% endif %}>{{ course.name }}</option>
        {% endfor %}
    </select>

    <!-- Form filter -->
    {% if forms %}
    <select name="form" onchange="this.form.submit()">
        <option value="">Select a form</option>
        {% for form in forms %}
        <option value="{{ form.id }}" {% if form.id|stringformat:"s" == selected_form_id %}selected{% endif %}>{{ form.title }}</option>
        {% endfor %}
    </select>
    {% endif %}

    <!-- Team filter -->
    {% if teams %}
    <select name="team" onchange="this.form.submit()">
        <option value="">Select a team</option>
        {% for team in teams %}
        <option value="{{ team.id }}" {% if team.id|stringformat:"s" == selected_team_id %}selected{% endif %}>{{ team.name }}</option>
        {% endfor %}
    </select>
    {% endif %}
</form>

<!-- Evaluation Cards -->
{% if evaluations %}
  {% for eval in evaluations %}
    <div class="bg-white p-6 shadow-md rounded-lg mb-6">
      <h2 class="text-2xl font-semibold mb-2">{{ eval.student.name }} ({{ eval.response_count }} response{{ eval.response_count|pluralize }})</h2>

      {% if eval.likert_scores %}
        <p class="font-medium">Likert Averages:</p>
        <ul class="list-disc pl-5 mb-2">
          {% for score in eval.likert_scores %}
            <li>{{ score.question_text }}: {{ score.avg_score|floatformat:2 }}</li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-gray-500 italic">No likert ratings.</p>
      {% endif %}

      {% if eval.comments %}
        <p class="font-medium">Comments:</p>
        <ul class="list-disc pl-5">
          {% for comment in eval.comments %}
            <li>{{ comment }}</li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-gray-500 italic">No comments received.</p>
      {% endif %}
    </div>
  {% endfor %}
{% elif selected_team_id %}
  <p class="text-gray-600">No responses found for this team.</p>
{% endif %}

{% endblock %}
